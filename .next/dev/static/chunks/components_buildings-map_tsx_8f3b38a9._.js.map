{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Documents/Smart-Almaty/Dashboards/Air%20condition%20two/air-quality/components/buildings-map.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useRef } from \"react\"\r\nimport L from \"leaflet\"\r\nimport \"leaflet/dist/leaflet.css\"\r\nimport \"leaflet.markercluster/dist/leaflet.markercluster\"\r\nimport \"leaflet.markercluster/dist/MarkerCluster.css\"\r\nimport \"leaflet.markercluster/dist/MarkerCluster.Default.css\"\r\nimport \"leaflet.heat\"\r\n\r\nif (typeof window !== 'undefined') {\r\n  require('leaflet.vectorgrid');\r\n}\r\n\r\ninterface Building {\r\n  id: string\r\n  address: string\r\n  district: string\r\n  latitude: number\r\n  longitude: number\r\n  has_gas: boolean\r\n  building_type: string\r\n  building_category: \"general\" | \"izhs\" | \"susn\"\r\n  geometry?: {\r\n    type: string\r\n    coordinates: any\r\n  } | null\r\n  floors?: number\r\n  apartments?: number\r\n  year_built?: number\r\n}\r\n\r\ninterface RenovationArea {\r\n  id: number\r\n  name_ru: string\r\n  name_kz?: string | null\r\n  address?: string | null\r\n  number_of_houses?: number | null\r\n  number_of_apartments?: number | null\r\n  plot_area?: string | null\r\n  photo_url?: string | null\r\n  geometry?: {\r\n    type: string\r\n    coordinates: any\r\n  } | null\r\n  created_at: string\r\n}\r\n\r\ninterface District {\r\n  id: number\r\n  name: string\r\n  geometry?: {\r\n    type: string\r\n    coordinates: any\r\n  } | null\r\n}\r\n\r\ninterface BuildingsMapProps {\r\n  buildings: Building[]\r\n  renovationAreas?: RenovationArea[]\r\n  districts?: District[]\r\n  selectedDistrictId?: number | null\r\n  showHeatmap?: boolean\r\n  showRenovationAreas?: boolean\r\n  onBuildingClick?: (building: Building) => void\r\n}\r\n\r\n// Fix Leaflet default marker icon issue\r\ndelete (L.Icon.Default.prototype as any)._getIconUrl\r\nL.Icon.Default.mergeOptions({\r\n  iconRetinaUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png\",\r\n  iconUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png\",\r\n  shadowUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png\",\r\n})\r\n\r\n// Function to create colored marker icons based on building category\r\nconst createMarkerIcon = (category: \"general\" | \"izhs\" | \"susn\") => {\r\n  // Different colors for each building type\r\n  const colors = {\r\n    general: \"#f97316\", // Orange - General buildings without gas\r\n    izhs: \"#3b82f6\",    // Blue - Individual housing construction (–ò–ñ–°)\r\n    susn: \"#ef4444\",    // Red - Multi-family buildings (–°–£–°–ù)\r\n  }\r\n\r\n  const emoji = {\r\n    general: \"üè†\", // House\r\n    izhs: \"üè°\",    // House with garden\r\n    susn: \"üè¢\",    // Office building\r\n  }\r\n\r\n  const color = colors[category]\r\n  const icon = emoji[category]\r\n\r\n  return L.divIcon({\r\n    className: \"custom-marker\",\r\n    html: `\r\n      <div style=\"\r\n        background-color: ${color};\r\n        width: 32px;\r\n        height: 32px;\r\n        border-radius: 50% 50% 50% 0;\r\n        transform: rotate(-45deg);\r\n        border: 3px solid white;\r\n        box-shadow: 0 2px 8px rgba(0,0,0,0.3);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        opacity: 0.85;\r\n        backdrop-filter: blur(2px);\r\n        transition: opacity 0.2s ease;\r\n      \">\r\n        <div style=\"\r\n          transform: rotate(45deg);\r\n          color: white;\r\n          font-size: 18px;\r\n          font-weight: bold;\r\n        \">${icon}</div>\r\n      </div>\r\n    `,\r\n    iconSize: [32, 32],\r\n    iconAnchor: [16, 32],\r\n    popupAnchor: [0, -32],\r\n  })\r\n}\r\n\r\nexport default function BuildingsMap({\r\n  buildings,\r\n  renovationAreas = [],\r\n  districts = [],\r\n  selectedDistrictId = null,\r\n  showHeatmap = false,\r\n  showRenovationAreas = false,\r\n  onBuildingClick\r\n}: BuildingsMapProps) {\r\n  const mapRef = useRef<HTMLDivElement>(null)\r\n  const mapInstanceRef = useRef<L.Map | null>(null)\r\n  const heatLayerRef = useRef<any>(null)\r\n  const clusterGroupRef = useRef<any>(null)\r\n  const districtLayerRef = useRef<L.LayerGroup | null>(null)\r\n  const renovationLayerRef = useRef<L.LayerGroup | null>(null)\r\n  const onBuildingClickRef = useRef(onBuildingClick)\r\n  const hasAutoFitted = useRef(false)\r\n  const canvasRendererRef = useRef<L.Canvas | null>(null)\r\n\r\n  // Keep the ref updated with the latest callback\r\n  useEffect(() => {\r\n    onBuildingClickRef.current = onBuildingClick\r\n  }, [onBuildingClick])\r\n\r\n  useEffect(() => {\r\n    if ('serviceWorker' in navigator) {\r\n      navigator.serviceWorker.register('/tile-sw.js')\r\n        .then(() => console.log(\"Tile Cache Worker Registered\"));\r\n    }\r\n  }, []);\r\n\r\n  // Initialize map only once\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\" || !mapRef.current || mapInstanceRef.current) return\r\n\r\n    // Center of Almaty\r\n    const mapCenter: [number, number] = [43.238293, 76.945465]\r\n\r\n    // Create canvas renderer for better performance with many markers\r\n    canvasRendererRef.current = L.canvas({ padding: 0.5 })\r\n\r\n    // Create Leaflet map with EPSG:3395 CRS for Yandex tiles\r\n    const map = L.map(mapRef.current, {\r\n      // crs: L.CRS.EPSG3395, // Yandex uses Mercator projection (EPSG:3395)\r\n      crs: L.CRS.EPSG3857,\r\n      center: mapCenter,\r\n      zoom: 11,\r\n      preferCanvas: true, // Use canvas for better performance\r\n      renderer: canvasRendererRef.current,\r\n      zoomAnimation: true,\r\n      markerZoomAnimation: true,\r\n      fadeAnimation: true,\r\n      // Performance optimizations\r\n      wheelDebounceTime: 40,\r\n      // wheelDebounceTime: 100,\r\n      // wheelPxPerZoomLevel: 60,\r\n    })\r\n\r\n    // Add Yandex tiles layer (no API key needed!)\r\n    // L.tileLayer(\"https://core-renderer-tiles.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&lang=ru_RU\", {\r\n    //   attribution: '&copy; <a href=\"https://yandex.com/maps/\">Yandex</a>',\r\n    //   maxZoom: 21, // Increased max zoom for closer inspection\r\n    //   minZoom: 0,\r\n    //   updateWhenIdle: false, // Update tiles during movement for smoother experience\r\n    //   updateWhenZooming: false, // Don't update while zooming\r\n    //   keepBuffer: 2, // Keep more tiles in buffer for smooth panning\r\n    // }).addTo(map)\r\n\r\n    L.tileLayer(\"https://core-renderer-tiles.maps.yandex.net/tiles?l=map&x={x}&y={y}&z={z}&lang=ru_RU&projection=web_mercator\", {\r\n      attribution: '&copy; <a href=\"https://yandex.com/maps/\">Yandex</a>',\r\n      maxZoom: 21,\r\n      minZoom: 0,\r\n      updateWhenIdle: false,\r\n      keepBuffer: 2,\r\n    }).addTo(map)\r\n\r\n    mapInstanceRef.current = map\r\n\r\n    return () => {\r\n      if (mapInstanceRef.current) {\r\n        mapInstanceRef.current.remove()\r\n        mapInstanceRef.current = null\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    if (!mapInstanceRef.current || typeof window === \"undefined\") return\r\n\r\n    const map = mapInstanceRef.current\r\n\r\n    // Clear existing layers\r\n    if (heatLayerRef.current) {\r\n      map.removeLayer(heatLayerRef.current)\r\n      heatLayerRef.current = null\r\n    }\r\n    if (clusterGroupRef.current) {\r\n      map.removeLayer(clusterGroupRef.current)\r\n      clusterGroupRef.current = null\r\n    }\r\n    if (districtLayerRef.current) {\r\n      map.removeLayer(districtLayerRef.current)\r\n      districtLayerRef.current = null\r\n    }\r\n    if (renovationLayerRef.current) {\r\n      map.removeLayer(renovationLayerRef.current)\r\n      renovationLayerRef.current = null\r\n    }\r\n\r\n    if (showHeatmap) {\r\n      const VectorGrid = (L as any).vectorGrid;\r\n\r\n      if (VectorGrid) {\r\n        const heatmapUrl = \"https://admin.smartalmaty.kz/api/v1/address/gas-heatmap/tiles/{z}/{x}/{y}.pbf\";\r\n        \r\n        const heatLayer = VectorGrid.protobuf(heatmapUrl, {\r\n          // rendererFactory: (L as any).svg.tile,\r\n          rendererFactory: (L as any).canvas.tile,\r\n          vectorTileLayerStyles: {\r\n            heatmap: (properties: any) => {\r\n              if (selectedDistrictId && properties.district_id !== selectedDistrictId) {\r\n                return {\r\n                  fill: false,\r\n                  stroke: false,\r\n                  opacity: 0,\r\n                  fillOpacity: 0\r\n                };\r\n              }\r\n              const val = Number(properties.intensity || 0);\r\n              \r\n              let color;\r\n              if (val === 0) {\r\n                color = '#22c55e';\r\n              } else if (val === 1) {\r\n                color = '#d4ce84ff';\r\n              } else if (val < 5) {\r\n                color = '#f97316';\r\n              } else if (val === 5) {\r\n                color = '#cf7e88ff';\r\n              } else if (val <= 20) {\r\n                color = '#ef4444';\r\n              } else {\r\n                color = '#7f1d1d';\r\n              }\r\n\r\n              return {\r\n                fill: true,\r\n                fillColor: color,\r\n                fillOpacity: 0.75,\r\n                stroke: false,\r\n                color: color,\r\n                weight: 1,\r\n                opacity: 0.2,\r\n              };\r\n            }\r\n          },\r\n          // srid: 3857, \r\n          interactive: true,\r\n          getFeatureId: (f: any) => f.properties.id, //new\r\n          maxNativeZoom: 14, //new\r\n          maxZoom: 21, //new\r\n          updateWhenIdle: true, //new\r\n          updateWhenZooming: false, //new\r\n          zIndex: 1000,\r\n          keepBuffer: 4, // Keep more tiles in memory to prevent white flickering\r\n          buffer: 512, // Larger buffer helps with labels/edges\r\n        });\r\n\r\n        heatLayer.addTo(map);\r\n        heatLayerRef.current = heatLayer;\r\n      }\r\n    } else {\r\n      // Cluster markers for performance on large datasets\r\n      // @ts-ignore markercluster is attached to L by side-effect import\r\n      const clusterGroup = L.markerClusterGroup({\r\n        disableClusteringAtZoom: 17, // Increased to 17 - keeps clustering longer for better performance\r\n        chunkedLoading: true,\r\n        chunkInterval: 200, // Faster chunk processing\r\n        chunkDelay: 50, // Less delay between chunks\r\n        maxClusterRadius: 60, // Increased radius for better grouping\r\n        spiderfyOnMaxZoom: true,\r\n        showCoverageOnHover: false, // Disable coverage on hover - improves performance\r\n        spiderfyDistanceMultiplier: 2, // Spread out spiderfied markers more\r\n        removeOutsideVisibleBounds: true, // Remove markers outside viewport for performance\r\n        animate: true, // Smooth animations\r\n        animateAddingMarkers: false, // Disable animation when adding markers for speed\r\n        iconCreateFunction: function (cluster: any) {\r\n          const markers = cluster.getAllChildMarkers()\r\n          const count = markers.length\r\n\r\n          // Count buildings by category\r\n          const categories = { general: 0, izhs: 0, susn: 0 }\r\n          markers.forEach((marker: any) => {\r\n            const building = marker.options.buildingData\r\n            if (building && building.building_category) {\r\n              const cat = building.building_category as keyof typeof categories\r\n              categories[cat]++\r\n            }\r\n          })\r\n\r\n          // Determine dominant category\r\n          let dominantCategory: \"general\" | \"izhs\" | \"susn\" = \"general\"\r\n          let maxCount = categories.general\r\n          if (categories.izhs > maxCount) {\r\n            dominantCategory = \"izhs\"\r\n            maxCount = categories.izhs\r\n          }\r\n          if (categories.susn > maxCount) {\r\n            dominantCategory = \"susn\"\r\n          }\r\n\r\n          // Color based on dominant category\r\n          const colors = {\r\n            general: \"#f97316\", // Orange\r\n            izhs: \"#3b82f6\",    // Blue\r\n            susn: \"#ef4444\",    // Red\r\n          }\r\n          const color = colors[dominantCategory]\r\n\r\n          // Size based on count\r\n          let size: \"small\" | \"medium\" | \"large\" = \"small\"\r\n          if (count >= 100) size = \"large\"\r\n          else if (count >= 50) size = \"medium\"\r\n\r\n          const sizeMap = {\r\n            small: \"40px\",\r\n            medium: \"50px\",\r\n            large: \"60px\",\r\n          }\r\n\r\n          return L.divIcon({\r\n            html: `\r\n              <div style=\"\r\n                background: ${color};\r\n                width: ${sizeMap[size]};\r\n                height: ${sizeMap[size]};\r\n                border-radius: 50%;\r\n                display: flex;\r\n                align-items: center;\r\n                justify-content: center;\r\n                border: 4px solid white;\r\n                box-shadow: 0 4px 12px rgba(0,0,0,0.25);\r\n                font-weight: bold;\r\n                color: white;\r\n                font-size: ${size === \"large\" ? \"18px\" : size === \"medium\" ? \"16px\" : \"14px\"};\r\n                opacity: 0.85;\r\n                backdrop-filter: blur(2px);\r\n                transition: opacity 0.2s ease;\r\n              \">\r\n                ${count}\r\n              </div>\r\n              <div style=\"\r\n                position: absolute;\r\n                bottom: -20px;\r\n                left: 50%;\r\n                transform: translateX(-50%);\r\n                background: rgba(0,0,0,0.7);\r\n                color: white;\r\n                padding: 2px 6px;\r\n                border-radius: 10px;\r\n                font-size: 9px;\r\n                white-space: nowrap;\r\n                display: none;\r\n              \" class=\"cluster-label\">\r\n                ${categories.general > 0 ? `üè†${categories.general}` : \"\"}\r\n                ${categories.izhs > 0 ? `üè°${categories.izhs}` : \"\"}\r\n                ${categories.susn > 0 ? `üè¢${categories.susn}` : \"\"}\r\n              </div>\r\n            `,\r\n            className: \"custom-cluster-icon\",\r\n            iconSize: L.point(parseInt(sizeMap[size]), parseInt(sizeMap[size])),\r\n          })\r\n        },\r\n      })\r\n\r\n      console.log(`üó∫Ô∏è Creating markers for ${buildings.length} buildings`)\r\n\r\n      let markersCreated = 0\r\n      buildings.forEach((building) => {\r\n        // Use different colored icon based on building category\r\n        const icon = createMarkerIcon(building.building_category)\r\n\r\n        const marker = L.marker([building.latitude, building.longitude], {\r\n          icon,\r\n          buildingData: building // Store building data for cluster calculations\r\n        } as any).bindPopup(\r\n          `\r\n          <div style=\"padding: 8px; min-width: 200px;\">\r\n            <strong style=\"font-size: 14px;\">${building.address}</strong>\r\n            <hr style=\"margin: 8px 0; border: none; border-top: 1px solid #e5e7eb;\">\r\n            <p style=\"margin: 4px 0; font-size: 12px;\"><strong>–†–∞–π–æ–Ω:</strong> ${building.district}</p>\r\n            <p style=\"margin: 4px 0; font-size: 12px;\"><strong>–¢–∏–ø:</strong> ${building.building_type}</p>\r\n            ${building.floors ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–≠—Ç–∞–∂–µ–π:</strong> ${building.floors}</p>` : \"\"}\r\n            ${building.apartments ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–ö–≤–∞—Ä—Ç–∏—Ä:</strong> ${building.apartments}</p>` : \"\"}\r\n            ${building.year_built ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–ì–æ–¥ –ø–æ—Å—Ç—Ä–æ–π–∫–∏:</strong> ${building.year_built}</p>` : \"\"}\r\n            <p style=\"margin: 8px 0 4px; color: #f97316; font-weight: bold; font-size: 12px;\">‚ö†Ô∏è –ë–µ–∑ –≥–∞–∑–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è</p>\r\n          </div>\r\n        `,\r\n        )\r\n\r\n        // Add click event to open side panel\r\n        marker.on(\"click\", () => {\r\n          if (onBuildingClickRef.current) {\r\n            onBuildingClickRef.current(building)\r\n          }\r\n        })\r\n\r\n        clusterGroup.addLayer(marker)\r\n        markersCreated++\r\n\r\n        // Draw polygons only at high zoom for performance (zoom 16+)\r\n        // Commented out to improve performance\r\n        /* if (building.geometry && building.geometry.type === \"MultiPolygon\" && map.getZoom() >= 16) {\r\n          const latLngPolys: L.LatLngExpression[][] = []\r\n          building.geometry.coordinates.forEach((poly: any) => {\r\n            const ring = poly[0]\r\n            const latLngs = ring.map((coord: [number, number]) => [coord[1], coord[0]])\r\n            latLngPolys.push(latLngs)\r\n          })\r\n          const htmlString = typeof icon.options.html === \"string\" ? icon.options.html : \"\"\r\n\r\n          // Determine color based on building category\r\n          const polygonColor = htmlString.includes(\"#3b82f6\")\r\n            ? \"#3b82f6\"\r\n            : htmlString.includes(\"#ef4444\")\r\n              ? \"#ef4444\"\r\n              : \"#f97316\"\r\n\r\n          L.polygon(latLngPolys, {\r\n            color: polygonColor,\r\n            weight: 1,\r\n            fillOpacity: 0.15,\r\n            renderer: canvasRendererRef.current || undefined, // Use canvas renderer for better performance\r\n            interactive: false, // Disable interaction to improve performance\r\n            smoothFactor: 2, // Simplify polygon for performance\r\n          }).addTo(map)\r\n        } */\r\n      })\r\n\r\n      // Add hover tooltip to clusters to show statistics\r\n      clusterGroup.on(\"clustermouseover\", function (event: any) {\r\n        const cluster = event.layer\r\n        const markers = cluster.getAllChildMarkers()\r\n\r\n        // Count buildings by category\r\n        const categories = { general: 0, izhs: 0, susn: 0 }\r\n        markers.forEach((marker: any) => {\r\n          const building = marker.options.buildingData\r\n          if (building && building.building_category) {\r\n            const cat = building.building_category as keyof typeof categories\r\n            categories[cat]++\r\n          }\r\n        })\r\n\r\n        const tooltipContent = `\r\n          <div style=\"padding: 10px; min-width: 180px; background: white; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);\">\r\n            <h3 style=\"font-size: 13px; font-weight: bold; margin-bottom: 8px; color: #111827;\">\r\n              –ö–ª–∞—Å—Ç–µ—Ä: ${markers.length} –∑–¥–∞–Ω–∏–π\r\n            </h3>\r\n            <div style=\"display: flex; flex-direction: column; gap: 6px;\">\r\n              ${categories.general > 0 ? `\r\n                <div style=\"display: flex; align-items: center; justify-content: space-between; padding: 4px 8px; background: #fff7ed; border-left: 3px solid #f97316; border-radius: 4px;\">\r\n                  <span style=\"font-size: 11px; color: #9a3412;\">üè† ALSECO</span>\r\n                  <span style=\"font-size: 13px; font-weight: bold; color: #f97316;\">${categories.general}</span>\r\n                </div>\r\n              ` : \"\"}\r\n              ${categories.izhs > 0 ? `\r\n                <div style=\"display: flex; align-items: center; justify-content: space-between; padding: 4px 8px; background: #eff6ff; border-left: 3px solid #3b82f6; border-radius: 4px;\">\r\n                  <span style=\"font-size: 11px; color: #1e3a8a;\">üè° –î–∞–Ω–Ω—ã–µ –†–∞–π–æ–Ω–Ω—ã—Ö –∞–∫–∏–º–∞—Ç–æ–≤</span>\r\n                  <span style=\"font-size: 13px; font-weight: bold; color: #3b82f6;\">${categories.izhs}</span>\r\n                </div>\r\n              ` : \"\"}\r\n              ${categories.susn > 0 ? `\r\n                <div style=\"display: flex; align-items: center; justify-content: space-between; padding: 4px 8px; background: #fef2f2; border-left: 3px solid #ef4444; border-radius: 4px;\">\r\n                  <span style=\"font-size: 11px; color: #7f1d1d;\">üè¢ –î–∞–Ω–Ω—ã–µ –î–ß–°</span>\r\n                  <span style=\"font-size: 13px; font-weight: bold; color: #ef4444;\">${categories.susn}</span>\r\n                </div>\r\n              ` : \"\"}\r\n            </div>\r\n            <p style=\"margin-top: 8px; font-size: 9px; color: #6b7280; text-align: center;\">\r\n              –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è\r\n            </p>\r\n          </div>\r\n        `\r\n\r\n        cluster.bindTooltip(tooltipContent, {\r\n          permanent: false,\r\n          direction: \"top\",\r\n          className: \"cluster-tooltip\",\r\n          offset: [0, -10],\r\n        }).openTooltip()\r\n      })\r\n\r\n      clusterGroup.on(\"clustermouseout\", function (event: any) {\r\n        const cluster = event.layer\r\n        cluster.closeTooltip()\r\n      })\r\n\r\n      // Click cluster to zoom in\r\n      clusterGroup.on(\"clusterclick\", function (event: any) {\r\n        const cluster = event.layer\r\n        cluster.zoomToBounds({ padding: [50, 50] })\r\n      })\r\n\r\n      clusterGroup.addTo(map)\r\n      clusterGroupRef.current = clusterGroup\r\n\r\n      console.log(`‚úÖ Successfully created ${markersCreated} markers on the map`)\r\n    }\r\n\r\n    // Render district polygons (filter by selectedDistrictId if specified)\r\n    if (districts.length > 0) {\r\n      const districtLayer = L.layerGroup()\r\n\r\n      // Filter districts: show only selected one if specified, otherwise show all\r\n      const districtsToRender = selectedDistrictId !== null\r\n        ? districts.filter(d => d.id === selectedDistrictId)\r\n        : districts\r\n\r\n      let selectedDistrictBounds: L.LatLngBounds | null = null\r\n\r\n      districtsToRender.forEach((district) => {\r\n        if (district.geometry && (district.geometry.type === \"Polygon\" || district.geometry.type === \"MultiPolygon\")) {\r\n          const coordinates = district.geometry.coordinates\r\n          const isSelected = district.id === selectedDistrictId\r\n\r\n          if (district.geometry.type === \"Polygon\") {\r\n            // Single polygon\r\n            const latLngs = coordinates[0].map((coord: [number, number]) => [coord[1], coord[0]])\r\n\r\n            const districtPolygon = L.polygon([latLngs], {\r\n              color: isSelected ? \"#3b82f6\" : \"#64748b\", // Blue for selected, slate gray for others\r\n              weight: isSelected ? 3 : 2,\r\n              fillOpacity: isSelected ? 0.15 : 0.05,\r\n              fillColor: isSelected ? \"#3b82f6\" : \"#94a3b8\",\r\n              renderer: canvasRendererRef.current || undefined,\r\n            })\r\n\r\n            const popupContent = `\r\n              <div style=\"padding: 8px; min-width: 150px;\">\r\n                <strong style=\"font-size: 14px; color: ${isSelected ? '#3b82f6' : '#64748b'};\">üìç ${district.name}</strong>\r\n              </div>\r\n            `\r\n            districtPolygon.bindPopup(popupContent)\r\n            districtLayer.addLayer(districtPolygon)\r\n\r\n            // Store bounds for zooming if this is the selected district\r\n            if (isSelected) {\r\n              selectedDistrictBounds = districtPolygon.getBounds()\r\n            }\r\n          } else if (district.geometry.type === \"MultiPolygon\") {\r\n            // Multiple polygons\r\n            const latLngPolys: L.LatLngExpression[][] = []\r\n            coordinates.forEach((polygon: any) => {\r\n              polygon.forEach((ring: any) => {\r\n                const latLngs = ring.map((coord: [number, number]) => [coord[1], coord[0]])\r\n                latLngPolys.push(latLngs)\r\n              })\r\n            })\r\n\r\n            const districtPolygon = L.polygon(latLngPolys, {\r\n              color: isSelected ? \"#3b82f6\" : \"#64748b\", // Blue for selected, slate gray for others\r\n              weight: isSelected ? 3 : 2,\r\n              fillOpacity: isSelected ? 0.15 : 0.05,\r\n              fillColor: isSelected ? \"#3b82f6\" : \"#94a3b8\",\r\n              renderer: canvasRendererRef.current || undefined,\r\n            })\r\n\r\n            const popupContent = `\r\n              <div style=\"padding: 8px; min-width: 150px;\">\r\n                <strong style=\"font-size: 14px; color: ${isSelected ? '#3b82f6' : '#64748b'};\">üìç ${district.name}</strong>\r\n              </div>\r\n            `\r\n            districtPolygon.bindPopup(popupContent)\r\n            districtLayer.addLayer(districtPolygon)\r\n\r\n            // Store bounds for zooming if this is the selected district\r\n            if (isSelected) {\r\n              selectedDistrictBounds = districtPolygon.getBounds()\r\n            }\r\n          }\r\n        }\r\n      })\r\n\r\n      districtLayer.addTo(map)\r\n      districtLayerRef.current = districtLayer\r\n\r\n      // Zoom to selected district if one is selected\r\n      if (selectedDistrictId !== null && selectedDistrictBounds) {\r\n        map.fitBounds(selectedDistrictBounds, {\r\n          padding: [50, 50],\r\n          maxZoom: 14 // Don't zoom in too close\r\n        })\r\n        console.log(`üéØ Zoomed to district ID ${selectedDistrictId}`)\r\n      }\r\n\r\n      console.log(`‚úÖ Successfully rendered ${districtsToRender.length} district polygon(s)`)\r\n    }\r\n\r\n    // Render renovation areas if enabled\r\n    if (showRenovationAreas && renovationAreas.length > 0) {\r\n      const renovationLayer = L.layerGroup()\r\n\r\n      renovationAreas.forEach((area) => {\r\n        if (area.geometry && area.geometry.type === \"MultiPolygon\") {\r\n          const coordinates = area.geometry.coordinates\r\n\r\n          // Convert MultiPolygon coordinates to Leaflet format\r\n          const latLngPolys: L.LatLngExpression[][] = []\r\n          coordinates.forEach((polygon: any) => {\r\n            polygon.forEach((ring: any) => {\r\n              const latLngs = ring.map((coord: [number, number]) => [coord[1], coord[0]])\r\n              latLngPolys.push(latLngs)\r\n            })\r\n          })\r\n\r\n          // Create polygon with styling\r\n          const renovationPolygon = L.polygon(latLngPolys, {\r\n            color: \"#8b5cf6\", // Purple color for renovation areas\r\n            weight: 2,\r\n            fillOpacity: 0.2,\r\n            fillColor: \"#8b5cf6\",\r\n            renderer: canvasRendererRef.current || undefined,\r\n          })\r\n\r\n          // Add popup with renovation area information\r\n          const popupContent = `\r\n            <div style=\"padding: 8px; min-width: 200px;\">\r\n              <strong style=\"font-size: 14px; color: #8b5cf6;\">üèóÔ∏è ${area.name_ru}</strong>\r\n              <hr style=\"margin: 8px 0; border: none; border-top: 1px solid #e5e7eb;\">\r\n              ${area.address ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–ê–¥—Ä–µ—Å:</strong> ${area.address}</p>` : \"\"}\r\n              ${area.number_of_houses ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ–≤:</strong> ${area.number_of_houses}</p>` : \"\"}\r\n              ${area.number_of_apartments ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–≤–∞—Ä—Ç–∏—Ä:</strong> ${area.number_of_apartments}</p>` : \"\"}\r\n              ${area.plot_area ? `<p style=\"margin: 4px 0; font-size: 12px;\"><strong>–ü–ª–æ—â–∞–¥—å —É—á–∞—Å—Ç–∫–∞:</strong> ${area.plot_area}</p>` : \"\"}\r\n              ${area.photo_url ? `<img src=\"${area.photo_url}\" alt=\"${area.name_ru}\" style=\"width: 100%; margin-top: 8px; border-radius: 4px;\" />` : \"\"}\r\n            </div>\r\n          `\r\n          renovationPolygon.bindPopup(popupContent)\r\n\r\n          renovationLayer.addLayer(renovationPolygon)\r\n        }\r\n      })\r\n\r\n      renovationLayer.addTo(map)\r\n      renovationLayerRef.current = renovationLayer\r\n\r\n      console.log(`‚úÖ Successfully rendered ${renovationAreas.length} renovation areas`)\r\n    }\r\n\r\n    // Auto-fit bounds only on first load, not on subsequent re-renders\r\n    if (buildings.length > 0 && !hasAutoFitted.current) {\r\n      const bounds = L.latLngBounds(buildings.map((b) => [b.latitude, b.longitude]))\r\n      map.fitBounds(bounds, { padding: [50, 50] })\r\n      hasAutoFitted.current = true\r\n    }\r\n  }, [buildings, showHeatmap, showRenovationAreas, renovationAreas, districts, selectedDistrictId])\r\n\r\n  return (\r\n    <>\r\n      <style jsx global>{`\r\n        .custom-marker > div:hover {\r\n          opacity: 1 !important;\r\n        }\r\n        .leaflet-marker-icon:hover {\r\n          z-index: 1000 !important;\r\n        }\r\n      `}</style>\r\n      <div ref={mapRef} className=\"h-full w-full\" />\r\n    </>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}}]
}